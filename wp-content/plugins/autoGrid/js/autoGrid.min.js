/* ======================================================= 
 * Auto Grid Responsive Gallery
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: June 6, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */

(function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var r=e.prototype,i=this,s=i.EventEmitter;r.getListeners=function(e){var t,n,r=this._getEvents();if("object"==typeof e){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},r.flattenListeners=function(e){var t,n=[];for(t=0;e.length>t;t+=1)n.push(e[t].listener);return n},r.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},r.addListener=function(e,n){var r,i=this.getListenersAsObject(e),s="object"==typeof n;for(r in i)i.hasOwnProperty(r)&&-1===t(i[r],n)&&i[r].push(s?n:{listener:n,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,n){var r,i,s=this.getListenersAsObject(e);for(i in s)s.hasOwnProperty(i)&&(r=t(s[i],n),-1!==r&&s[i].splice(r,1));return this},r.off=n("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)s.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?s.call(this,r,i):o.call(this,r,i));return this},r.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if("object"===n)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(e,t){var n,r,i,s,o=this.getListenersAsObject(e);for(i in o)if(o.hasOwnProperty(i))for(r=o[i].length;r--;)n=o[i][r],n.once===!0&&this.removeListener(e,n.listener),s=n.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},r.trigger=n("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=s,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}).call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,r=function(){};n.addEventListener?r=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(r=function(e,n,r){e[n+r]=r.handleEvent?function(){var n=t(e);r.handleEvent.call(r,n)}:function(){var n=t(e);r.call(e,n)},e.attachEvent("on"+n,e[n+r])});var i=function(){};n.removeEventListener?i=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(i=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(r){e[t+n]=void 0}});var s={bind:r,unbind:i};"function"==typeof define&&define.amd?define("eventie/eventie",s):e.eventie=s}(this),function(e,t){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,r){return t(e,n,r)}):"object"==typeof exports?module.exports=t(e,require("eventEmitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(this,function(e,t,n){function r(e,t){for(var n in t)e[n]=t[n];return e}function i(e){return"[object Array]"===h.call(e)}function s(e){var t=[];if(i(e))t=e;else if("number"==typeof e.length)for(var n=0,r=e.length;r>n;n++)t.push(e[n]);else t.push(e);return t}function o(e,t,n){if(!(this instanceof o))return new o(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=s(e),this.options=r({},this.options),"function"==typeof t?n=t:r(this.options,t),n&&this.on("always",n),this.getImages(),f&&(this.jqDeferred=new f.Deferred);var i=this;setTimeout(function(){i.check()})}function u(e){this.img=e}function a(e){this.src=e,p[e]=this}var f=e.jQuery,l=e.console,c=l!==void 0,h=Object.prototype.toString;o.prototype=new t,o.prototype.options={},o.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;t>e;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);for(var r=n.querySelectorAll("img"),i=0,s=r.length;s>i;i++){var o=r[i];this.addImage(o)}}},o.prototype.addImage=function(e){var t=new u(e);this.images.push(t)},o.prototype.check=function(){function e(e,i){return t.options.debug&&c&&l.log("confirm",e,i),t.progress(e),n++,n===r&&t.complete(),!0}var t=this,n=0,r=this.images.length;if(this.hasAnyBroken=!1,!r)return this.complete(),void 0;for(var i=0;r>i;i++){var s=this.images[i];s.on("confirm",e),s.check()}},o.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){if(t.emit(e,t),t.emit("always",t),t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},f&&(f.fn.imagesLoaded=function(e,t){var n=new o(this,e,t);return n.jqDeferred.promise(f(this))}),u.prototype=new t,u.prototype.check=function(){var e=p[this.img.src]||new a(this.img.src);if(e.isConfirmed)return this.confirm(e.isLoaded,"cached was confirmed"),void 0;if(this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var t=this;e.on("confirm",function(e,n){return t.confirm(e.isLoaded,n),!0}),e.check()},u.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)};var p={};return a.prototype=new t,a.prototype.check=function(){if(!this.isChecked){var e=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0}},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},a.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},a.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},a.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},o});(function(e,t,n){"use strict";var r=t.event,i=t.event.handle?"handle":"dispatch",s;r.special.smartresize={setup:function(){t(this).bind("resize",r.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",r.special.smartresize.handler)},handler:function(e,t){var n=this,o=arguments;e.type="smartresize";if(s){clearTimeout(s)}s=setTimeout(function(){r[i].apply(n,o)},t==="execAsap"?0:100)}};t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])};t.AutoGridMasonry=function(e,n){this.element=t(n);this._create(e);this._init()};t.AutoGridMasonry.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500,complete:function(){var e=t(this);if(!e.hasClass("autoGridGallery-brick")){if(t.fn.autoGridGallery.defaults.lazyLoad){t.waypoints("refresh")}if(e.hasClass("autoGridGallery-with-loading-boxes")){e.removeClass("autoGridGallery-with-loading-boxes");e.addClass("completeAddingImages")}}}},gutterWidth:0,isRTL:false,isFitWidth:false,containerStyle:{position:"relative"}};t.AutoGridMasonry.prototype={_resized:false,_filterFindBricks:function(e){var t=this.options.itemSelector;return!t?e:e.filter(t).add(e.find(t))},_getBricks:function(e){var t=this._filterFindBricks(e).css({position:"absolute"}).addClass("autoGridGallery-brick");return t},_create:function(n){this.options=t.extend(true,{},t.AutoGridMasonry.settings,n);this.styleQueue=[];var r=this.element[0].style;this.originalStyle={height:r.height||""};var i=this.options.containerStyle;for(var s in i){this.originalStyle[s]=r[s]||""}this.element.css(i);this.horizontalDirection=this.options.isRTL?"right":"left";var o=this.element.css("padding-"+this.horizontalDirection);var u=this.element.css("padding-top");this.offset={x:o?parseInt(o,10):0,y:u?parseInt(u,10):0};this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth==="function";var a=this;setTimeout(function(){a.element.addClass("autoGridGallery")},0);if(this.options.isResizable){t(e).bind("smartresize.autoGridGallery",function(){a.resize()})}this.reloadItems()},_init:function(e){this._getColumns();this._reLayout(e)},option:function(e,n){if(t.isPlainObject(e)){this.options=t.extend(true,this.options,e)}},layout:function(e,t){for(var n=0,r=e.length;n<r;n++){this._placeBrick(e[n])}var i={};i.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var s=0;n=this.cols;while(--n){if(this.colYs[n]!==0){break}s++}i.width=(this.cols-s)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:i});var o=!this.isLaidOut?"css":this.options.isAnimated?"animate":"css",u=this.options.animationOptions;var a;var f=false;for(n=0,r=this.styleQueue.length;n<r;n++){a=this.styleQueue[n];o=!this.isLaidOut?"css":this.options.isAnimated?"animate":"css";var l=a.$el.hasClass("loading-box");if(l&&!this.element.hasClass("noSupportTransform")){o="css";f=true}else if(f){a.$el["css"](a.style,u)}a.$el.removeClass("loading-box");var c=a.$el.css("left");var h=a.$el.css("top");var p=a.style.left+"px";var d=a.style.top+"px";if(c==p&&h==d||l==true){a.$el.data("moving",false)}else{a.$el.data("moving",true)}var v=500;a.$el[o](a.style,u)}this.styleQueue=[];if(t){t.call(e)}this.isLaidOut=true},_getColumns:function(){var e=this.options.isFitWidth?this.element.parent():this.element,t=e.width();this.columnWidth=this.isFluid?this.options.columnWidth(t):this.options.columnWidth||this.$bricks.outerWidth(true)||t;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((t+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(e){var n=t(e),r,i,s,o,u;r=Math.ceil(n.outerWidth(true)/this.columnWidth);r=Math.min(r,this.cols);if(r===1){s=this.colYs}else{i=this.cols+1-r;s=[];for(u=0;u<i;u++){o=this.colYs.slice(u,u+r);s[u]=Math.max.apply(Math,o)}}var a=Math.min.apply(Math,s),f=0;for(var l=0,c=s.length;l<c;l++){if(s[l]===a){f=l;break}}var h={top:a+this.offset.y};h[this.horizontalDirection]=this.columnWidth*f+this.offset.x;this.styleQueue.push({$el:n,style:h});var p=a+n.outerHeight(true),d=this.cols+1-c;for(l=0;l<d;l++){this.colYs[f+l]=p}},resize:function(){var e=this.cols;this._getColumns();if(this.isFluid||this.cols!==e){this._reLayout()}},_reLayout:function(e){var t=this.cols;this.colYs=[];while(t--){this.colYs.push(0)}this.layout(this.$bricks,e)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(e){this.reloadItems();this._init(e)},appended:function(e,t,n){if(t){this._filterFindBricks(e).css({top:this.element.height()});var r=this;setTimeout(function(){r._appended(e,n)},1)}else{this._appended(e,n)}},_appended:function(e,t){var n=this._getBricks(e);this.$bricks=this.$bricks.add(n);this.layout(n,t)},remove:function(e){this.$bricks=this.$bricks.not(e);e.remove()},destroy:function(){this.$bricks.removeClass("autoGridGallery-brick").each(function(){this.style.position="";this.style.top="";this.style.left=""});var n=this.element[0].style;for(var r in this.originalStyle){n[r]=this.originalStyle[r]}this.element.unbind(".autoGridGallery").removeClass("autoGridGallery").removeData("autoGridGallery");t(e).unbind(".autoGridGallery")}};t.fn.autoGridGallery=function(r){var i=function(i){var s=t.extend({},t.fn.autoGridGallery.defaults,r);t.fn.autoGridGallery.defaults.lazyLoad=r.lazyLoad;if(r==n){r={}}r.isFitWidth=s.isFitWidth;r.isAnimated=s.isAnimated;r.itemSelector=".agrg_box";r.gutterWidth=s.horizontalSpaceBetweenThumbnails;var o=t(i);var u=s.columnWidth;if(u=="auto"){r.columnWidth=function(e){var t=-999;for(var n=s.columns;n>=1;n--){if(t<s.columnMinWidth){t=(e-(n-1)*r.gutterWidth)/n|0}}o.find("div.agrg_box").width(t);return t}}else if(typeof u!="function"){r.columnWidth=function(e){var t=u;o.find("div.agrg_box").width(t);return t}}o.find("div.agrg_box").css("margin-bottom",s.verticalSpaceBetweenThumbnails);var a=function(){var e=document.createElement("div"),t="Khtml ms O Moz Webkit".split(" "),n=t.length;return function(r){if(r in e.style)return true;r=r.replace(/^[a-z]/,function(e){return e.toUpperCase()});while(n--){if(t[n]+r in e.style){return true}}return false}}();if(!a("transform")){o.addClass("noSupportTransform")}else{o.addClass("visible")}var f=null;var l=o.data("directory");var c=o.data("path");var h=o.data("site");var p=t('<ul class="category-navbar" />').hide().insertBefore(o);var d=function(){var e=p.find("li[class=select]").data("category");return e};var v=t("<div />").insertAfter(o);var m=function(){v.addClass("grid-loader").removeClass("grid-loadMore").html("")};var g=function(){v.removeClass("grid-loader")};var y=false;var b=function(e){var t=0;for(var n in f){var r=f[n];if(e==n||e=="all"){for(var i in r){t++}}}if(t>0){y=false;return true}else{return false}};var w=function(e){if(e){v.addClass("grid-loadMore").html("LOAD MORE IMAGES")}else{v.removeClass("grid-loadMore").html("")}};var E=function(e,t,n){var r="thumbnails/";if(n=="no"){r=""}var i=e+"/";if(e=="all"){i=""}var o=t.split(/\.(?=[^.]*$)/)[0];var u="<h5>In "+e+"</h5>";if(e=="all"||s.captionCategory==false){u=""}var a="";if(o.indexOf("$$")!=-1){var f=o.split("$$");o=f[0];var h=f[1].split(":").join("/");h=h.split("|").join("/");a='data-url="'+h+'"'}if(o.substr(1,1)=="-"){o=o.substr(2)}var p='<div class="agrg_box" data-category="'+e+'" '+a+">"+'<img src="'+c+l+"/"+i+r+t+'" data-lightbox="'+c+l+"/"+i+t+'" />'+'<div class="image-caption">'+"<h3>"+o+"</h3>"+u+"</div>"+'<div class="lightbox-text">'+o+" <span>In "+e+"</span>"+"</div>"+"</div>";return p};var S=function(){var e=d();if(e!="all"){o.children("div").not('.agrg_box[data-category="'+e+'"]').removeClass("agrg_box autoGridGallery-brick").hide()}};var x=function(e){e=t(e).addClass("loading-box");e.css("margin-bottom",s.verticalSpaceBetweenThumbnails);o.append(e.hide());o.imagesLoaded(function(){e.hide();S();o.addClass("autoGridGallery-with-loading-boxes");o.autoGridGallery("reload");var t=[];t.push(e);A(t,[]);g();w(b(d()));y=false})};var T=function(e){var t=[];var n=Array();for(var r in e){if(e.hasOwnProperty(r)){t.push(e[r].order.toLowerCase()+"-&$&$-"+r)}}t.sort();if(s.imagesOrder=="byName"||s.imagesOrder=="byDateReverse"){}else{t.reverse()}jQuery.each(t,function(t,r){var i=r.split("-&$&$-");i=i[1];n.push(e[i])});return n};var N=function(e){m();var t=0;for(var n in f){var r=f[n];var i=0;for(var o in r){i++}if(i>t)t=i}var u=new Array;if(s.aleatoryImagesFromCategories){for(var a=0;a<t;a++){var l=0;for(var n in f){r=f[n];var c=n;if(l==0){c="all"}var h=0;for(var o in r){if(h==a){u.push({category:c,image:o,thumb:r[o].thumb,order:r[o].order,categoryOriginal:n});break}h++}l++}}}else{var l=0;for(var n in f){var r=f[n];var c=n;if(l==0){c="all"}for(var o in r){u.push({category:c,image:o,thumb:r[o].thumb,order:r[o].order,categoryOriginal:n})}l++}}if(s.orderInAll&&s.imagesOrder!="random"){u=T(u)}var p="";var d=0;while(d<e){if(d>=u.length)break;var v=u[d];p+=E(v["category"],v["image"],v["thumb"]);delete f[v["categoryOriginal"]][v["image"]];d++}x(p)};var C=function(e,t){m();var n=new Array;var r=0;for(var i in f){var o=f[i];var u=i;if(r==0){u="all"}if(u==t){for(var a in o){n.push({category:u,image:a,thumb:o[a].thumb,order:o[a].order,categoryOriginal:i})}}r++}if(s.orderInAll&&s.imagesOrder!="random"){n=T(n)}var l="";var c=0;while(c<e){if(c>=n.length)break;var h=n[c];l+=E(h["category"],h["image"],h["thumb"]);delete f[h["categoryOriginal"]][h["image"]];c++}x(l)};var k=function(){if(v.hasClass("grid-loadMore")){var e=d();if(e=="all"){N(s.imagesToLoad)}else{C(s.imagesToLoad,e)}}};v.on("click",function(){k()});if(s.lazyLoad){o.waypoint(function(e){var n=t(this);if(n.hasClass("completeAddingImages")){if(v.hasClass("grid-loadMore")){k();n.removeClass("completeAddingImages")}}},{context:e,continuous:true,enabled:true,horizontal:false,offset:"bottom-in-view",triggerOnce:false})}var L=function(){var e=0;for(var n in f){var r=n;if(r.substr(1,1)=="-"){r=r.substr(2)}var i=t("<li />").data("category",n).appendTo(p);t("<a />").html(r).appendTo(i);if(e==0){i.addClass("select");i.data("category","all")}e++}if(s.smartNavBar&&e<=2){s.showNavBar=false}if(s.showNavBar){p.slideDown(400)}};var A=function(e,n){for(var i=0;i<e.length;i++){e[i].each(function(){var e=t(this).removeClass("noTransform");if(e.hasClass("autoGridGallery-brick")){if(e.is(":hidden")){if(o.hasClass("noSupportTransform")){e.show()}else{e.show();if(e.data("moving")==false){e.animate(s.hiddenStyle,0);e.animate(s.visibleStyle,400,function(){e.addClass("noTransform")})}else{e.animate(s.visibleStyle,0);e.addClass("noTransform")}}}else{e.animate(s.visibleStyle,r.animOpts,function(){e.addClass("noTransform")})}}})}for(var i=0;i<n.length;i++){n[i].each(function(){var e=t(this).removeClass("noTransform");if(e.is(":hidden")==false){e.addClass("box");if(o.hasClass("noSupportTransform")){e.hide();e.removeClass("box")}else{e.animate(s.visibleStyle,0);e.animate(s.hiddenStyle,r.animOpts,function(){e.hide();e.removeClass("box")})}}else{}})}};var O=l.split("../").join("-back-");t.getJSON(c+"reader.php?directory="+O+"&categoriesOrder="+s.categoriesOrder+"&imagesOrder="+s.imagesOrder,function(e){f=e;if(jQuery.isArray(e["All"])){e["All"]={}}p.css("display","none");L();N(s.imagesToLoadStart)});p.on("click","a",function(e){e.preventDefault();var t=jQuery(this);if(t.parent("li").hasClass("select")){return}o.removeClass("completeAddingImages");o.addClass("autoGridGallery-with-loading-boxes");t.parent("li").addClass("select").siblings("li").removeClass("select");var r=o;var i=t.parent("li").data("category");var s=[];var u=[];if(i=="all"){var a=r.children("div").addClass("agrg_box autoGridGallery-brick");if(o.hasClass("noSupportTransform")){a.css({top:200,left:200})}s.push(a)}else{var f=r.children('div[data-category="'+i+'"]').addClass("agrg_box autoGridGallery-brick");if(f[0]!=n){if(o.hasClass("noSupportTransform")){f.css({top:200,left:200})}s.push(f.stop())}var l=r.children("div").not('.agrg_box[data-category="'+i+'"]').removeClass("agrg_box autoGridGallery-brick");u.push(l)}o.autoGridGallery("reload");A(s,u);w(b(d()))});o.on("mouseenter.hoverdir, mouseleave.hoverdir","div.agrg_box",function(e){if(!s.caption)return;var r=t(this),i=e.type,o=r.find("div.image-caption"),u=M(r,{x:e.pageX,y:e.pageY}),a=_(u,r);var f=o.children("div.aligment");if(f[0]==n){var l=o.html();o.html("<div class='aligment'><div class='aligment'>"+l+"</div></div>")}if(i==="mouseenter"){if(s.captionType=="classic"){o.css({left:0,top:0});o.fadeIn(300);return}o.css({left:a.from,top:a.to});o.stop().show().fadeTo(0,1,function(){t(this).stop().animate({top:0,left:0},200,"linear")})}else{if(s.captionType=="classic"){o.css({left:0,top:0});o.fadeOut(300);return}if(s.captionType=="grd-fade"){o.fadeOut(700)}else{o.stop().animate({left:a.from,top:a.to},200,"linear",function(){o.hide()})}}});var M=function(e,t){var n=e.width(),r=e.height(),i=(t.x-e.offset().left-n/2)*(n>r?r/n:1),s=(t.y-e.offset().top-r/2)*(r>n?n/r:1),o=Math.round((Math.atan2(s,i)*(180/Math.PI)+180)/90+3)%4;return o};var _=function(e,t){var n,r;switch(e){case 0:if(!s.reverse){n=0,r=-t.height()}else{n=0,r=-t.height()}break;case 1:if(!s.reverse){n=t.width(),r=0}else{n=-t.width(),r=0}break;case 2:if(!s.reverse){n=0,r=t.height()}else{n=0,r=-t.height()}break;case 3:if(!s.reverse){n=-t.width(),r=0}else{n=t.width(),r=0}break}return{from:n,to:r}};var D=t("body");var P={interval:"none"};var H=0;var B=t('<div class="autoGrid-lightbox" />').appendTo(D);var j=t('<div class="autoGrid-nav" />').appendTo(B);var F=t('<div class="autoGrid-close" />').appendTo(j);var I=t('<i class="iconClose" />').appendTo(F);var q=t('<div class="autoGrid-play" />');if(s.lightboxPlayBtn){q.appendTo(j)}var R=t('<i class="iconPlay" />').appendTo(q);var U=t('<div class="autoGrid-lbcaption" />').appendTo(j).html("Here will go the text for the lightbox");var z=t('<div class="autoGrid-next" />').appendTo(j);var W=t('<i class="iconNext" />').appendTo(z);var X=t('<div class="autoGrid-prev" />').appendTo(j);var V=t('<i class="iconPrev" />').appendTo(X);var J=t('<div class="lightbox-timer" />').appendTo(B);var K=F.width();var Q=3;if(s.lightboxPlayBtn)Q=4;var G=function(){var e=B.outerWidth(false);if(e<650){U.hide();z.css("width",e/Q);X.css("width",e/Q);q.css("width",e/Q);F.css("width",e-e/Q*(Q-1))}else{U.show();z.css("width",K);X.css("width",K);q.css("width",K);F.css("width",K)}var t=B.find("img");var n=B.outerHeight(false)-j.outerHeight(false);t.css("max-height",n)};jQuery(e).resize(function(){G()});var Y=new Image;var Z=function(){if(Y!=null){Y.onload=null;Y=null}B.find(".lightbox-alignment").remove();B.find(".lightbox-alignment2").remove();B.find("img").remove()};var et=function(){B.find(".lb-loader").remove()};var tt=function(){B.append('<div class="lb-loader"/>')};B.attr("unselectable","on").css("user-select","none").on("selectstart",false);var nt=function(){J.stop(true,true).width(0)};var rt=function(){clearInterval(P.interval)};var it=function(){if(s.lightBoxShowTimer==false)return;J.css({position:"absolute",bottom:0}).animate({width:"100%"},s.lightBoxPlayInterval,"linear",function(){nt()})};var st=false;var ot=false;var ut=function(){P.interval=setTimeout(function(){vt()},s.lightBoxPlayInterval);it()};var at=function(){if(st&&ot==false){nt();rt();ut()}};var ft=t("<span />");var lt=function(e,r){Z();et();tt();var i=0;var o=0;if(r!=true){i=.9;o=s.lightBoxSpeedFx}if(s.lightBoxZoomAnim==false){i=1}var u=e;var a=u.data("lightbox");if(a==n){a=u.attr("src")}var f=u.siblings("div.lightbox-text").html();if(s.lightBoxText==false){f=""}var l=f.split("<span>")[0];var c="<div class='ag-social-container'>";if(s.fb!=n){c+="<div class='ag-fb' data-url='"+h+a+"' data-name='"+l+"' ></div>"}if(s.twitter!=n){c+="<div class='ag-tw' data-url='"+h+a+"' data-name='"+l+"' ></div>"}if(s.googlePlus!=n){c+="<div class='ag-gp' data-url='"+h+a+"' data-name='"+l+"' ></div>"}if(s.pinterest!=n){c+="<div class='ag-pi'data-url='"+h+a+"' data-name='"+l+"' ></div>"}c+="</div>";var p="<div><div>"+f+" &nbsp;&nbsp;"+c+"</div></div>";U.html(p);Y=new Image;var d=t(Y);var v=Y;Y.onload=function(){if(v!=Y)return;et();var e=t('<div class="lightbox-alignment"></div>').appendTo(B);var n=t('<div class="lightbox-alignment2"></div>').appendTo(e);n.append(d.css("margin-top",-j.outerHeight(false)).hide().scale(i));d.fadeIn(o).animate({scale:"1"},{duration:s.lightBoxSpeedFx,complete:function(){at()}});G()};Y.src=a;ft.stop(true);ft=t(Y)};var ct=function(t){var n=e.open(t,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");n.moveTo(screen.width/2-300,screen.height/2-200)};j.on("click","div.ag-fb",function(){var e=t(this);var n=encodeURIComponent(e.data("url"));n="https://www.facebook.com/sharer/sharer.php?u="+n;ct(n)});j.on("click","div.ag-tw",function(){var e=t(this);var n=encodeURIComponent(e.data("url"));n="https://twitter.com/intent/tweet?url=&text="+encodeURIComponent(e.data("name"))+" "+n;ct(n)});j.on("click","div.ag-gp",function(){var e=t(this);var n=encodeURIComponent(e.data("url"));n="https://plus.google.com/share?url="+n;ct(n)});j.on("click","div.ag-pi",function(){var e=t(this);var n=encodeURIComponent(e.data("url"));n="http://pinterest.com/pin/create/button/?url="+n+"&media="+n;ct(n)});var ht=false;var pt="";o.on("click","div.agrg_box",function(){ht=true;var r=t(this);var i=r.data("url");pt="";if(i!=n&&s.linkOnLightbox==true){pt="http://"+i}else if(i!=n){if(s.linkOnSamePage==false){e.open("http://"+i,"_blank")}else{location.href="http://"+i}return}if(s.lightBox==false){return}ot=false;H=o.find(".agrg_box").index(this);var u=r.children("img");j.animate({"margin-top":0},s.lightBoxSpeedFx);B.fadeIn(s.lightBoxSpeedFx);lt(u,true)});B.on("click","div",function(e){e.stopPropagation()});B.on("click","img",function(e){e.stopPropagation()});B.on("click",".lightbox-alignment",function(){dt()});B.on("click",".lightbox-alignment2",function(){dt()});B.on("click",function(){dt()});F.on("click",function(){dt()});var dt=function(){if(s.lightBoxStopPlayOnClose){q.removeClass("selected");st=false}ht=false;ot=true;nt();rt();B.find(".lb-loader").remove();var e=0;if(s.lightBoxZoomAnim==false){e=1}var t=B.find("img").stop().show();j.animate({"margin-top":-j.outerHeight(false)},s.lightBoxSpeedFx);if(t[0]!=n){t.animate({scale:e},s.lightBoxSpeedFx,function(){B.fadeOut(100)})}else{B.fadeOut(100)}};var vt=function(){ot=false;var e=o.find(".agrg_box");H+=1;if(H>=e.length){H=0}if(!e.eq(H).is(":visible")){var t=H;for(var r=0;r<e.length;r++){t++;if(t>=e.length){t=0}if(e.eq(t).is(":visible")){H=t;break}}}var i=e.eq(H).children("img");var u=e.eq(H).data("url");pt="";if(u!=n&&s.linkOnLightbox==true){pt="http://"+u}lt(i)};var mt=function(){ot=false;var e=o.find(".agrg_box");H-=1;if(H<0){H=e.length-1}if(!e.eq(H).is(":visible")){var t=H;for(var r=0;r<e.length;r++){t--;if(t<0){t=e.length-1}if(e.eq(t).is(":visible")){H=t;break}}}var i=e.eq(H).children("img");var u=e.eq(H).data("url");pt="";if(u!=n&&s.linkOnLightbox==true){pt="http://"+u}lt(i)};z.on("click",function(){nt();rt();vt()});B.on("click","img",function(){if(pt==""){nt();rt();vt()}else{if(s.linkOnSamePage==false){e.open(pt,"_blank")}else{location.href=pt}}});X.on("click",function(){nt();rt();mt()});if(s.someSecurity){B.on("contextmenu","img",function(e){return false});B.on("dragstart","img",function(e){e.preventDefault()})}t(document).keyup(function(e){if(!s.lightboxKeyboardNav)return;if(e.keyCode=="37"){if(ht==false)return;nt();rt();mt()}if(e.keyCode=="39"){if(ht==false)return;nt();rt();vt()}if(e.keyCode==27){dt()}});if(s.lightBoxAutoPlay){q.addClass("selected");st=true}q.on("click",function(){i=t(this);if(i.hasClass("selected")){i.removeClass("selected");st=false;nt();rt()}else{i.addClass("selected");st=true;ut()}})};if(typeof r==="string"){var s=Array.prototype.slice.call(arguments,1);this.each(function(){var e=t.data(this,"autoGridGallery");if(!e){logError("cannot call methods on autoGridGallery prior to initialization; "+"attempted to call method '"+r+"'");return}if(!t.isFunction(e[r])||r.charAt(0)==="_"){logError("no such method '"+r+"' for autoGridGallery instance");return}e[r].apply(e,s)})}else{this.each(function(){var e=t.data(this,"autoGridGallery");if(e){e.option(r||{});e._init()}else{i(this);t.data(this,"autoGridGallery",new t.AutoGridMasonry(r,this))}})}return this};t.fn.autoGridGallery.defaults={categoriesOrder:"byDate",imagesOrder:"byDate",orderInAll:true,isFitWidth:true,lazyLoad:false,showNavBar:true,smartNavBar:true,imagesToLoadStart:15,imagesToLoad:5,aleatoryImagesFromCategories:true,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:220,isAnimated:true,caption:true,captionCategory:true,captionType:"grid-fade",lightBox:true,lightboxKeyboardNav:true,lightBoxSpeedFx:500,lightBoxZoomAnim:true,lightBoxText:true,lightboxPlayBtn:true,lightBoxAutoPlay:false,lightBoxPlayInterval:4e3,lightBoxShowTimer:true,lightBoxStopPlayOnClose:false,someSecurity:false,linkOnLightbox:true,hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1}}})(window,jQuery)
